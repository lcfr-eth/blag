<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="dark">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Rescuing ENS names from compromised wallets." />
<meta property="og:locale" content="en" />
<meta name="description" content="A minimal, responsive and feature-rich Jekyll theme for technical writing." />
<meta property="og:description" content="A minimal, responsive and feature-rich Jekyll theme for technical writing." />
<link rel="canonical" href="http://0.0.0.0:4000/posts/rescue-ens-names/" />
<meta property="og:url" content="http://0.0.0.0:4000/posts/rescue-ens-names/" />
<meta property="og:site_name" content="LCFR" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-18T20:28:22-04:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Rescuing ENS names from compromised wallets." />
<meta name="twitter:site" content="@lcfr_eth" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-18T20:28:22-04:00","datePublished":"2022-05-18T20:28:22-04:00","description":"A minimal, responsive and feature-rich Jekyll theme for technical writing.","headline":"Rescuing ENS names from compromised wallets.","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/posts/rescue-ens-names/"},"url":"http://0.0.0.0:4000/posts/rescue-ens-names/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Rescuing ENS names from compromised wallets. | LCFR
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="LCFR">
<meta name="application-name" content="LCFR">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="https://upload.wikimedia.org/wikipedia/commons/9/9d/Paradise_Lost_12.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">LCFR</a>
    <p class="site-subtitle fst-italic mb-0">nobody</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/lcfr-eth"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/lcfr_eth"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['nobody','lcfr.io'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Rescuing ENS names from compromised wallets.</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Rescuing ENS names from compromised wallets.</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1652920102"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  May 18, 2022
</time>

      </span>

      <!-- lastmod date -->
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/lcfr_eth">LCFR</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1734 words"
>
  <em>9 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Rescuing ENS names from compromised wallets.</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Rescuing ENS names from compromised wallets.</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <p><a href="https://upload.wikimedia.org/assets/img/lost.jpeg" class="popup img-link  shimmer"><img src="https://upload.wikimedia.org/assets/img/lost.jpeg" alt="image" loading="lazy"></a></p>

<p>Recently <a href="https://ens.vision">we</a> had a client message our support channel asking about strange transactions.</p>

<p>Shortly after we determined the users wallet had been compromised and a drainer/sweeper script attached to the address.</p>

<p>Understandably the user was quite frantic but patient and allowed us to come up with a plan to try and help rescue his ENS names.</p>

<h1 id="the-drainer-problem">The “drainer” problem:</h1>

<p>Generally when a wallet is compromised, an attacker will leave some tokens as bait for the owner to send funds to try and transfer.</p>

<p>The trap works as follows:</p>

<p>1) Wallet is compromised &amp; drained of ETH. The attacker leaves some tokens in the compromised wallet.</p>

<p>2) This means the owner can not transfer the tokens in the wallet until they send it more ether to cover the gas fee.</p>

<p>3) Wait for the legitimate owner to try and save their precious tokens by sending more ETH to cover the gas fees of transfer methods and and steal that ETH also.</p>

<p>A “sweeper” loads a private key of a hacked account and attempts to send the full balance in a loop.</p>

<p>If there is no balance it simply reverts before broadcasting.</p>

<p>If it has a balance the funds are sent instantly.</p>

<p>This kind of attack is low effort and cost as it only requires a web3 rpc connection to query an accounts balance and broadcast transactions.</p>

<p>Enabling it to run indefinately for basically free.</p>

<p>Below is an example of a basic drainer script that attempts to send all ETH every 60 seconds if it has enough balance to cover the cost of gas:</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">web3</span> <span class="kn">import</span> <span class="n">Web3</span><span class="p">,</span> <span class="n">HTTPProvider</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="c1"># Connect to Ethereum node
</span><span class="n">w3</span> <span class="o">=</span> <span class="nc">Web3</span><span class="p">(</span><span class="nc">HTTPProvider</span><span class="p">(</span><span class="sh">'</span><span class="s">INFURA</span><span class="sh">'</span><span class="p">))</span>  <span class="c1"># Replace with your node address
</span>
<span class="c1"># Replace with your account details
</span><span class="n">account</span> <span class="o">=</span> <span class="sh">"</span><span class="s">YOUR_ACCOUNT_ADDRESS</span><span class="sh">"</span>
<span class="n">private_key</span> <span class="o">=</span> <span class="sh">"</span><span class="s">YOUR_PRIVATE_KEY</span><span class="sh">"</span>
<span class="n">destination_account</span> <span class="o">=</span> <span class="sh">"</span><span class="s">DESTINATION_ACCOUNT_ADDRESS</span><span class="sh">"</span>

<span class="k">def</span> <span class="nf">send_all_eth</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">private_key</span><span class="p">,</span> <span class="n">destination_account</span><span class="p">):</span>
    <span class="c1"># Get account balance
</span>    <span class="n">balance</span> <span class="o">=</span> <span class="n">w3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="nf">getBalance</span><span class="p">(</span><span class="n">account</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">balance</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Estimate gas
</span>        <span class="n">gas_estimate</span> <span class="o">=</span> <span class="n">w3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="nf">estimateGas</span><span class="p">({</span>
            <span class="sh">"</span><span class="s">from</span><span class="sh">"</span><span class="p">:</span> <span class="n">account</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">to</span><span class="sh">"</span><span class="p">:</span> <span class="n">destination_account</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">value</span><span class="sh">"</span><span class="p">:</span> <span class="n">balance</span>
        <span class="p">})</span>
        <span class="c1"># Check if balance is sufficient for gas
</span>        <span class="k">if</span> <span class="n">balance</span> <span class="o">&gt;</span> <span class="n">gas_estimate</span> <span class="o">*</span> <span class="n">w3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="n">gasPrice</span><span class="p">:</span>
            <span class="c1"># Build transaction
</span>            <span class="n">transaction</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">from</span><span class="sh">"</span><span class="p">:</span> <span class="n">account</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">to</span><span class="sh">"</span><span class="p">:</span> <span class="n">destination_account</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">value</span><span class="sh">"</span><span class="p">:</span> <span class="n">balance</span> <span class="o">-</span> <span class="n">gas_estimate</span> <span class="o">*</span> <span class="n">w3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="n">gasPrice</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">gas</span><span class="sh">"</span><span class="p">:</span> <span class="n">gas_estimate</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">gasPrice</span><span class="sh">"</span><span class="p">:</span> <span class="n">w3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="n">gasPrice</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">nonce</span><span class="sh">"</span><span class="p">:</span> <span class="n">w3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="nf">getTransactionCount</span><span class="p">(</span><span class="n">account</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="c1"># Sign transaction
</span>            <span class="n">signed_transaction</span> <span class="o">=</span> <span class="n">w3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="n">account</span><span class="p">.</span><span class="nf">signTransaction</span><span class="p">(</span><span class="n">transaction</span><span class="p">,</span> <span class="n">private_key</span><span class="p">)</span>
            <span class="c1"># Send transaction
</span>            <span class="n">tx_hash</span> <span class="o">=</span> <span class="n">w3</span><span class="p">.</span><span class="n">eth</span><span class="p">.</span><span class="nf">sendRawTransaction</span><span class="p">(</span><span class="n">signed_transaction</span><span class="p">.</span><span class="n">rawTransaction</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Transaction hash: </span><span class="si">{</span><span class="n">tx_hash</span><span class="p">.</span><span class="nf">hex</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Balance is not sufficient to cover gas costs.</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Balance is zero.</span><span class="sh">"</span><span class="p">)</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="c1"># Send all Ethereum from account to destination_account
</span>    <span class="nf">send_all_eth</span><span class="p">(</span><span class="n">account</span><span class="p">,</span> <span class="n">private_key</span><span class="p">,</span> <span class="n">destination_account</span><span class="p">)</span>
    <span class="c1"># Sleep for 60 seconds
</span>    <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></div></div>

<h1 id="the-solution-flashbots">The solution: Flashbots</h1>

<p><a href="https://docs.flashbots.net/">Flashbots</a> on a high level enables a client to submit Bundles of transactions.</p>

<p><a href="https://docs.flashbots.net/flashbots-auction/searchers/advanced/understanding-bundles">Understanding bundles</a></p>

<p>Bundles are one or more transactions that are grouped together and executed in the order they are provided.</p>

<p>Note: if a transaction in a bundle would revert then the whole bundle will be disgarded and not be included in a block. Only bundles of successful transactions will be included unless reverting transactions are specified when submitting the bundle which explicitaly state which transactions are allowed to revert.</p>

<p>All of this sounds great and allows technical people to submit bundles to a Flashbots relay through the use of specifically written code that usually loads the accounts private key directly. As demonstrated above with the web3.py example.</p>

<p>What about people who are simply not technical enough to run specialized python or node scripts to build and submit Flashbots bundles?</p>

<p>Flashbots have recently updated the RPC to enable transaction or <a href="https://docs.flashbots.net/flashbots-protect/rpc/bundle-cache">Bundle Caching</a>.</p>

<p>A client simply needs to generate a special id that works as a bundle id with the flashbots RPC in Metamask.<br />
Example: <code class="language-plaintext highlighter-rouge">https://rpc.flashbots.net/bundle?id=111-222-333-444</code></p>

<h1 id="building-a-better-bundler">Building a better bundler</h1>

<p>The Scaffold ETH bundler was fairly basic and only allowed Sending ETH and entering a contracts ABI to add a transaction from.<br />
-picture-</p>

<p>That works well for fungible tokens such as ERC20 or ERC1155 that can transfer multiple tokens or the full balance in a single transaction.</p>

<p>ERC721 tokens have no methods to transfer multiple tokens in a single transaction. Tokens such as ENS would require adding 1x safeTransferFrom or transferFrom call per tokenId to a bundle.</p>

<p>In the past there were size limitations on bundles. Unsure of the current size limitations of a bundle I decided to write a small contract to aid in transferring all of this clients ENS names.</p>

<p>A basic <code class="language-plaintext highlighter-rouge">transferProxy</code> contract was written and used for this client.</p>

<p>The contract needs to be approved by the _from address on the collection address.</p>

<p>The contract also requires the caller be approved by the <code class="language-plaintext highlighter-rouge">from</code> address as an authentication check to prevent users transferring other peoples names who have approved the contract.</p>

<h3 id="basic-transferproxysol"><span class="me-2">Basic transferProxy.sol</span><a href="#basic-transferproxysol" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="n">contract</span> <span class="nc">Transfer</span> <span class="o">{</span>

    <span class="n">function</span> <span class="nf">bulkTransfer</span><span class="o">(</span><span class="n">uint256</span><span class="o">[]</span> <span class="n">calldata</span> <span class="n">tokens</span><span class="o">,</span> <span class="n">address</span> <span class="n">from</span><span class="o">,</span> <span class="n">address</span> <span class="n">to</span><span class="o">,</span> <span class="n">address</span> <span class="n">collection</span> <span class="o">)</span> <span class="kd">public</span> <span class="o">{</span>
        <span class="n">uint256</span> <span class="n">length</span> <span class="o">=</span> <span class="n">tokens</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>

        <span class="c1">// check if caller is approved by the owner on collection to transfer tokens</span>
        <span class="o">(,</span><span class="n">bytes</span> <span class="n">memory</span> <span class="n">dataApproved</span> <span class="o">)</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="na">staticcall</span><span class="o">(</span><span class="n">abi</span><span class="o">.</span><span class="na">encodeWithSignature</span><span class="o">(</span><span class="s">"isApprovedForAll(address,address)"</span><span class="o">,</span> <span class="n">from</span><span class="o">,</span> <span class="n">msg</span><span class="o">.</span><span class="na">sender</span><span class="o">));</span>
        <span class="n">bool</span> <span class="n">isApproved</span> <span class="o">=</span> <span class="n">abi</span><span class="o">.</span><span class="na">decode</span><span class="o">(</span><span class="n">dataApproved</span><span class="o">,</span> <span class="o">(</span><span class="n">bool</span><span class="o">));</span>
        <span class="n">require</span><span class="o">(</span><span class="n">isApproved</span><span class="o">,</span> <span class="s">"Caller Not approved by Owner"</span><span class="o">);</span>

        <span class="n">unchecked</span> <span class="o">{</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">uint256</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">;)</span> <span class="o">{</span>
                <span class="c1">// transfer token from the owner to the receiver</span>
                <span class="n">collection</span><span class="o">.</span><span class="na">call</span><span class="o">(</span><span class="n">abi</span><span class="o">.</span><span class="na">encodeWithSignature</span><span class="o">(</span><span class="s">"safeTransferFrom(address,address,uint256)"</span><span class="o">,</span> <span class="n">from</span><span class="o">,</span> <span class="n">to</span><span class="o">,</span> <span class="n">tokens</span><span class="o">[</span><span class="n">i</span><span class="o">]));</span>
                <span class="o">++</span><span class="n">i</span><span class="o">;</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<p>The contract was refined and rewritten in yul to be more effecient :</p>

<h3 id="optimized-transferproxysol"><span class="me-2">Optimized transferProxy.sol</span><a href="#optimized-transferproxysol" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre></td><td class="rouge-code"><pre><span class="n">contract</span> <span class="n">transferProxy</span> <span class="o">{</span>

    <span class="c1">// custom error = 0x383462e29</span>
    <span class="n">error</span> <span class="nf">notApproved</span><span class="o">();</span>

    <span class="n">function</span> <span class="nf">transfer</span><span class="o">(</span><span class="n">bytes</span><span class="o">[]</span> <span class="n">calldata</span> <span class="n">_data</span><span class="o">,</span> <span class="n">address</span> <span class="n">_contract</span><span class="o">,</span> <span class="n">address</span> <span class="n">_from</span><span class="o">)</span> <span class="n">external</span> <span class="o">{</span>
        <span class="n">assembly</span> <span class="o">{</span>
            <span class="c1">// checks if the caller is approved by _from on _contract</span>
            <span class="c1">//</span>
            <span class="c1">// store the selector for isApprovedForAll at memory offset 0x00-0x04</span>
            <span class="n">mstore</span><span class="o">(</span><span class="mh">0x00</span><span class="o">,</span> <span class="n">shl</span><span class="o">(</span><span class="mi">224</span><span class="o">,</span> <span class="mh">0xe985e9c5</span><span class="o">))</span> 
            <span class="c1">// store the _from parameter in the calldata 0x04-0x24</span>
            <span class="n">mstore</span><span class="o">(</span><span class="mh">0x04</span><span class="o">,</span> <span class="n">_from</span><span class="o">)</span> 
            <span class="c1">// store the msg.sender as the operator parameter at 0x24-0x44</span>
            <span class="n">mstore</span><span class="o">(</span><span class="mh">0x24</span><span class="o">,</span> <span class="n">caller</span><span class="o">())</span>
            <span class="c1">// perform staticcall on the contract with the stored calldata from memory 0x00 - 0x44 </span>
            <span class="n">let</span> <span class="n">success</span> <span class="o">:=</span> <span class="n">staticcall</span><span class="o">(</span><span class="n">gas</span><span class="o">(),</span> <span class="n">_contract</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x44</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">)</span>
            <span class="c1">// call is finished, overwrite the calldata at 0x00 with returndata</span>
            <span class="n">returndatacopy</span><span class="o">(</span><span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="n">returndatasize</span><span class="o">())</span>
            <span class="c1">// if call failed then revert</span>
            <span class="k">if</span> <span class="nf">iszero</span><span class="o">(</span><span class="n">success</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">revert</span><span class="o">(</span><span class="mh">0x00</span><span class="o">,</span> <span class="n">returndatasize</span><span class="o">())</span>
            <span class="o">}</span>
            <span class="c1">// if the caller isnt approved revert with custom error 'notApproved'</span>
            <span class="k">if</span> <span class="nf">iszero</span><span class="o">(</span><span class="n">mload</span><span class="o">(</span><span class="mh">0x00</span><span class="o">))</span> <span class="o">{</span>
                <span class="c1">// store the selector for the notApproved error at 0x00 - 0x4</span>
                <span class="n">mstore</span><span class="o">(</span><span class="mh">0x00</span><span class="o">,</span> <span class="n">shl</span><span class="o">(</span><span class="mi">224</span><span class="o">,</span> <span class="mh">0x383462e29</span><span class="o">))</span>
                <span class="c1">// revert with the custom error selector at 0x00-0x4</span>
                <span class="n">revert</span><span class="o">(</span><span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x04</span><span class="o">)</span>
            <span class="o">}</span>

            <span class="n">let</span> <span class="n">i</span> <span class="o">:=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="o">{}</span> <span class="mi">1</span> <span class="o">{</span> <span class="nl">i:</span><span class="o">=</span> <span class="n">add</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="mi">1</span><span class="o">)</span> <span class="o">}</span> <span class="o">{</span>
                <span class="c1">// i starts at 0 while length starts at 1</span>
                <span class="k">if</span> <span class="nf">eq</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">_data</span><span class="o">.</span><span class="na">length</span><span class="o">){</span> <span class="k">break</span> <span class="o">}</span>
                <span class="c1">// elements start at _data.offset</span>
                <span class="c1">// +0x00: length</span>
                <span class="c1">// +0x20: data</span>
                <span class="c1">// shl(5, i) = mul(0x20, i)</span>
                <span class="n">let</span> <span class="n">data</span> <span class="o">:=</span> <span class="n">calldataload</span><span class="o">(</span><span class="n">add</span><span class="o">(</span><span class="n">_data</span><span class="o">.</span><span class="na">offset</span><span class="o">,</span> <span class="n">shl</span><span class="o">(</span><span class="mi">5</span><span class="o">,</span> <span class="n">i</span><span class="o">)))</span>
                <span class="n">let</span> <span class="n">len</span> <span class="o">:=</span> <span class="n">calldataload</span><span class="o">(</span><span class="n">add</span><span class="o">(</span><span class="n">_data</span><span class="o">.</span><span class="na">offset</span><span class="o">,</span> <span class="n">data</span><span class="o">))</span>
                <span class="c1">// copy the bytes string from the array to 0x00 </span>
                <span class="n">calldatacopy</span><span class="o">(</span><span class="mh">0x00</span><span class="o">,</span> <span class="n">add</span><span class="o">(</span><span class="n">_data</span><span class="o">.</span><span class="na">offset</span><span class="o">,</span> <span class="n">add</span><span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="mh">0x20</span><span class="o">)),</span> <span class="n">len</span><span class="o">)</span>
                <span class="c1">// call the _contract with the calldata copied to 0x00    </span>
                <span class="n">success</span> <span class="o">:=</span> <span class="n">call</span><span class="o">(</span> <span class="n">gas</span><span class="o">(),</span> <span class="n">_contract</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="n">len</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">)</span>
                <span class="c1">// if a call reverts then revert the entire call.</span>
                <span class="k">if</span> <span class="nf">iszero</span><span class="o">(</span><span class="n">success</span><span class="o">)</span> <span class="o">{</span>
                    <span class="c1">// copy the revert reason to 0x00</span>
                    <span class="n">returndatacopy</span><span class="o">(</span><span class="mh">0x00</span><span class="o">,</span> <span class="mh">0x00</span><span class="o">,</span> <span class="n">returndatasize</span><span class="o">())</span>
                    <span class="c1">// return the revert from 0x00</span>
                    <span class="n">revert</span><span class="o">(</span><span class="mh">0x00</span><span class="o">,</span> <span class="n">returndatasize</span><span class="o">())</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>
<h1 id="building-a-better-bundler--cont">Building a better bundler .. cont.</h1>

<p>With a more effecient ERC721 transfer contract I then added the code to the UI to check if the specified contract was an ERC721 or ERC1155.</p>

<p>This is accomplished by checking if the contract implements the <code class="language-plaintext highlighter-rouge">supportsInterface(ERC721InterfaceId)</code> or <code class="language-plaintext highlighter-rouge">supportsInterface(ERC1155InterfaceId)</code>.</p>

<p>Where <code class="language-plaintext highlighter-rouge">ERC1155InterfaceId = "0xd9b67a26"</code> and <code class="language-plaintext highlighter-rouge">ERC721InterfaceId = "0x80ac58cd"</code>.</p>

<p>Now the function will use the built-in ERC1155 safeBatchTransferFrom method for ERC1155 tokens and the transferProxy for ERC721 tokens.</p>

<p>Some additional functionality added and UI changes include:</p>

<p>1) Added Transfer NFTs tab that checks and selects between using the transferProxy for ERC721 or the built-in safeBatchTransferFrom for ERC1155 tokens.</p>

<p>2) Added the ERC20 tab that will check the connected wallets balance for the provided contract and offer a 1-click button to add a transaction to a bundle that transfers the connected wallets entire balance to a new address.</p>

<p>3) Added a New Bundle tab and button for generating a new UUID / Bundle ID for easily submitting multiple bundles.</p>

<p>4) Added a button for automatically adding and changing to the bundle RPC in MetaMask.</p>

<p>5) Added a Submit Bundle tab for submitting finalized bundles and crafting bundles easier.</p>

<h1 id="rescue">Rescue</h1>

<p>With all of the code ready I decided to ask the client in this instance to provide the compromised private key to make sure everything went smooth and execute the transactions from my wallet for gas.</p>

<p>1) Imported the private key of the compromised wallet in Metamask.<br />
2) Changed to clean address in Metamask with ETH.<br />
3) Clicked the New Bundle tab.<br />
4) Generate a new bundle UUID.<br />
5) Click the button to add the RPC to Metamask.<br />
6) Click the Send ETH tab.<br />
7) Click to estimate the cost.  <br />
8) As ENS is an ERC721 we need to do two approvals. Copy the cost for two approvals.<br />
9) Click Send Eth to add the transaction to the bundle.<br />
10) Change to the hacked wallet in metamask.<br />
11) Click the Set NFT Approvals tab.<br />
12) Enter the ENS contract address.<br />
13) Enter the hacked address that holds the ENS names. <br />
14) Enter the unhacked address that will receive the names. <br />
15) Click to add the first approval tx to the bundle.  This approves the new address for the hacked address.<br />
16) Click to add the second approval tx to the bundle. This approves the transferProxy contract.<br />
17) Click the submit bundle tab. Wait for the bundle to be included.<br />
18) Optional: Disconnect the flashbots RPC and connect to Ethereum Mainnet in Metamask.<br />
19) Click the Transfer NFT’s tab.<br />
20) Enter the ENS contract address.<br />
21) Enter the hacked address that holds the ENS names.<br />
22) Enter the unhacked address that will receive the names. <br />
23) Enter the tokenIds 1 per line in the input area.<br />
24) Click to broadcast the transaction.</p>

<h1 id="poc">PoC</h1>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/web3/">web3</a>
      </div>
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Rescuing%20ENS%20names%20from%20compromised%20wallets.%20-%20LCFR&url=http%3A%2F%2F0.0.0.0%3A4000%2Fposts%2Frescue-ens-names%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=Rescuing%20ENS%20names%20from%20compromised%20wallets.%20-%20LCFR&u=http%3A%2F%2F0.0.0.0%3A4000%2Fposts%2Frescue-ens-names%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2F0.0.0.0%3A4000%2Fposts%2Frescue-ens-names%2F&text=Rescuing%20ENS%20names%20from%20compromised%20wallets.%20-%20LCFR" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/ens-namewrapper-bounty/">Bounty: ENS NameWrapper expiry issue</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/rescue-ens-names/">Rescuing ENS names from compromised wallets.</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/duplicate-ens-names/">Bounty: Using a Web2 bug to duplicate ENS names</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/local-ssh-2fa-bypass/">Session Riding OpenSSH (multiplexing) to bypass 2FA</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->


















            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  
    
  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/ens-namewrapper-bounty/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1671928102"
  data-df="ll"
  
>
  Dec 24, 2022
</time>

              <h4 class="pt-0 my-2">Bounty: ENS NameWrapper expiry issue</h4>
              <div class="text-muted">
                <p>Quick Links About ENS and ENS Subdomains About the NameWrapper Finding the bug Proof of Concept Patch Reward  About ENS and ENS Subdomains Currently Ethereum Name Service or just ENS for short is a...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/duplicate-ens-names/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1651451302"
  data-df="ll"
  
>
  May  1, 2022
</time>

              <h4 class="pt-0 my-2">Bounty: Using a Web2 bug to duplicate ENS names</h4>
              <div class="text-muted">
                <p>Quick Links About ENS: Decentralized Domain Name System ENS Registration &amp;amp; Metadata explained ENS Subgraph Service ENS Metadata Service ZWJ, ZWNJ, ZWSP ? Null-bytes &amp;amp; String termination Ide...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/duplicate-ens-names/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Bounty: Using a Web2 bug to duplicate ENS names</p>
    </a>
  

  
    <a
      href="/posts/ens-namewrapper-bounty/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Bounty: ENS NameWrapper expiry issue</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/lcfr_eth">LCFR</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->


















    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

